const w=window.innerWidth,shiftFactor=.35,shiftAmmount=.35*w,startAirport="CYYZ";var addInitialOffset=!0,startColor=!0;const colors=[["#CCF381","#4831D4"],["#D198C5FF","#E0C568FF"],["#89ABE3FF","#EA738DFF"],["#FDF5DF","#F92C85"],["#2BAE66FF","#FCF6F5FF"],["#9400D3","#FFAA33"]],globe=Globe()(document.getElementById("globeViz")).globeImageUrl("//unpkg.com/three-globe/example/img/earth-dark.jpg").bumpImageUrl("//unpkg.com/three-globe/example/img/earth-topology.png").backgroundImageUrl("//unpkg.com/three-globe/example/img/night-sky.png").width(w+shiftAmmount).pointOfView({lat:29.197123,lng:-46.185931,altitude:2.2}).arcsTransitionDuration(500).arcDashLength(.15).arcDashGap(.01).arcDashInitialGap((()=>Math.random())).arcDashAnimateTime(6e3).onArcHover(showRoute).labelText("label").labelSize(1.5).labelDotRadius(.4).labelAltitude(.1).labelDotOrientation((()=>"right")).labelColor((()=>"whitesmoke")).labelsTransitionDuration(0);function getTimes(){return currentTime=Math.floor(Date.now()/1e3)-263e4,prevTime=currentTime-172800,[String(prevTime),String(currentTime)]}function getData(t,e){const a=DATA[e].lat,r=DATA[e].long;rotateGlobe(a,r),times=getTimes();var o=[];const l="https://opensky-network.org/api/flights/departure?airport="+e+"&begin="+times[0]+"&end="+times[1];var n=new XMLHttpRequest;n.open("GET",l,!0),n.onload=function(){var l=JSON.parse(this.response),i=new Set;n.status>=200&&n.status<400?l.forEach((t=>{const l=t.estArrivalAirport;null!=l&&1!=i.has(l)&&l!=e&&null!=DATA[l]&&(i.add(l),arrivalAirportData=DATA[t.estArrivalAirport],o.push({startLat:a,startLng:r,endLat:arrivalAirportData.lat,endLng:arrivalAirportData.long,arrICAO:l,arrCity:arrivalAirportData.city,arrCountry:arrivalAirportData.country}))})):console.log("error"),t(o,e)},n.send()}function rotateGlobe(t,e){1==addInitialOffset?(globe.pointOfView({lat:35,lng:-60,altitude:2.2},600),addInitialOffset=!1):globe.pointOfView({lat:t,lng:e,altitude:2.2},600)}function setRoutes(t,e){newLabel=[{lat:DATA[e].lat,lng:DATA[e].long,label:DATA[e].name+" ("+e+")"}],1==startColor?(globe.arcColor(colors[0]),startColor=!1):globe.arcColor(colors[Math.floor(Math.random()*colors.length)]),globe.labelsData(newLabel),globe.arcsData(t)}function btnSubmit(){getData(callback=setRoutes,ICAO=document.getElementById("fICAO").value)}getData(callback=setRoutes,ICAO="CYYZ");var el=document.getElementById("bICAO");function showRoute(t,e){null!=t&&globe.arcLabel(["â†’ "+t.arrCity+", "+t.arrCountry+" ("+t.arrICAO+")"])}el.addEventListener("click",btnSubmit);